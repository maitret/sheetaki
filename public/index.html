<html>
<head>
<title>Micro servicio de Conversión de Hojas de Cálculo</title>
</head>
<body>
<style> a { text-decoration: none } </style>
<pre>
<b>Proxy:</b> envíe una solicitud a /api/data para convertir la hoja de cálculo en `url` a un formato más simple

<b>parameters:</b>
- url=&lt;url&gt;      la url para solicitar
- N=&lt;idx&gt;        el índice de hoja a usar (-1 devuelve una lista de nombres de hoja en el libro de trabajo)
- t=&lt;type&gt;       tipo de exportación: "json" para json, "html" para html, el valor predeterminado es CSV

<b>examples:</b>
</pre>
<pre id="examples"></pre>
<script>
var URL1 = "https://obamawhitehouse.archives.gov/sites/default/files/omb/budget/fy2014/assets/receipts.xls";
var URL2 = "https://www.ers.usda.gov/webdocs/DataFiles/50048/Feed%20Grains%20Yearbook%20Tables-All%20Years.xls?v=42839"
var URLS = [
	["[CSV] ", {url:URL1}],
	["[JSON]", {url:URL1, t:"json"}],
	["[HTML]", {url:URL1, t:"html"}],
	[],
	["[LIST]", {url:URL2,N:-1}],
	["[N=1] ", {url:URL2,N:1}],
	["[N=2] ", {url:URL2,N:2}],
	["[N=3] ", {url:URL2,N:3}],
	["[N=4] ", {url:URL2,N:4}],
	["[N=5] ", {url:URL2,N:5}],
	["[N=6] ", {url:URL2,N:6}],
	["[N=7] ", {url:URL2,N:7}],
	["[N=8] ", {url:URL2,N:8}]
];
var parms = ["N", "t"];
for(var i = 0; i < URLS.length; ++i) {
	if(URLS[i].length < 2) { document.getElementById("examples").innerHTML += (URLS[i][0]||"") + "\n"; continue; }
	var path = '/api/data?url=' + URLS[i][1].url;
	for(var j = 0; j < parms.length; ++j) if(URLS[i][1][parms[j]]) path += '&' + parms[j] + '=' + URLS[i][1][parms[j]];
	document.getElementById("examples").innerHTML += '- ' + URLS[i][0] + ' <a href="' + path + '">' + path + '</a>\n';
}
</script>
<pre>

<b>Upload:</b> suba un archivo a /api/upload para convertir la hoja de cálculo en `url` a un formato más simple

<b>parameters:</b>
- N=&lt;idx&gt;        el índice de hoja a usar (-1 devuelve una lista de nombres de hoja en el libro de trabajo)
- t=&lt;type&gt;       tipo de exportación: "json" para json, "html" para html, el valor predeterminado es CSV

<b>example:</b>
<form method="POST" action="api/upload" enctype="multipart/form-data"><input type="hidden" name="N" value="0">
<label for="file">Subir archivo</label>
<input type="file" name="file" id="file">

<label for="t">Export type</label>
<select name="t" id="t">
	<option value="csv">CSV</option>
	<option value="json" selected>JSON</option>
	<option value="html">Tabla HTML</option>
</select>

<input type="submit" value="Click para Subir">
</form>

<b>This service is powered by <a href="https://www.maivall.com">MaiVall</a></b>

<b>Código fuente (Autor):</b>

- <a href="https://github.com/SheetJS/sheetaki"Código fuente para este servicio</a>
- <a href="https://github.com/SheetJS/sheetjs">Código fuente para la biblioteca de hojas de cálculo SheetJS</a>
</pre>

</body>
</html>
